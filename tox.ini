[tox]
envlist = {py36,py37,py38}-{dj2.2,dj3.0},coverage,docs

[testenv]
deps =
    django-mptt
    flake8
    coverage
    dj2.2: Django>=2.2,<3.0
    dj3.0: Django>=3.0,<3.1

commands =
    flake8 .
    coverage run manage.py test
    coverage report -m --fail-under 85


[testenv:coverage]
passenv = TRAVIS TRAVIS_JOB_ID TRAVIS_BRANCH
basepython = python3.8
commands =
    coverage run manage.py test
    coverage report -m --fail-under 85
deps =
    coverage
    Django>=3.0,<3.1

[testenv:docs]
basepython = python3.8
deps = Sphinx
commands = {envbindir}/sphinx-build -a -n -b html -d docs/_build/doctrees docs docs/_build/html
